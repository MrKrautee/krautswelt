{% extends "admin/change_list.html" %}
{% load i18n admin_urls static admin_list %}

{% block extrastyle %}
  {{ block.super }}
<link rel="stylesheet" type="text/css" href="{% static "pages/css/page_tree.css" %}" />
{% endblock %}

{% block extrahead %}
{{ block.super }}
<script>
    window.model = "{{ cl.opts.object_name }}";
    window.app_label = "{{ cl.opts.app_label }}";
</script>
{% endblock %}


{% if not is_popup %}
{% block breadcrumbs %}
<div class="breadcrumbs">
<a href="{% url 'admin:index' %}">{% trans 'Home' %}</a>
&rsaquo; <a href="{% url 'admin:app_list' app_label=cl.opts.app_label %}">{{ cl.opts.app_config.verbose_name }}</a>
&rsaquo; {{ cl.opts.verbose_name_plural|capfirst }}
</div>
{% endblock %}
{% endif %}

{% block coltype %}flex{% endblock %}

{% block content %}
app: {{ cl.opts.app_label }}<br />
model: {{ cl.opts.object_name }}<br />

<script type="text/javascript">
(function($) { 
$(document).ready(function() {
    function hide_row(parent){
        parent = parent.replace(" -  [hide]", "").trim();
        var tableRow = $("td.field-parent").filter(function() {
            return $(this).text().trim() == parent;
        }).closest("tr").each(function(){
                $(this).children('th.field-indented_title').each(function(){
                    var title = $(this).text().replace(" -  [hide]", "");
                    hide_row(title);
                });
                $(this).toggle();
            });
        
    }
//      hide_row("Blog");
     $('table#result_list tr').each(function(){
        var title = $('div.box-text', this).text();
        var children = $('td.field-get_children', this).text();
        if(children.length >1){
            var a = $("<a href='#' style='font-size:0.8em;'>  -  [hide]</a>");
            a.click(function(){hide_row(title);});
            $('div.box-text', this).append("</a> ");
            $('div.box-text', this).append(a);
        }
     });
    })
})(django.jQuery);
</script>
{{ block.super }}
{% endblock %}
